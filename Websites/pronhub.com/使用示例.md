# M3U8播放功能使用示例

## 功能概述

已成功为采集系统添加了m3u8播放功能，用户现在可以直接在浏览器中播放采集到的m3u8地址视频。

## 使用方法

### 1. 运行采集程序

```bash
# 进入项目目录
cd Websites/pronhub.com

# 运行采集程序
python app.py
```

### 2. 查看采集结果

采集完成后，在 `data/[viewkey]/` 目录下会生成包含m3u8播放器的HTML页面：

```
data/
├── 683ab19b3f7ec/
│   ├── index.html          # 包含m3u8播放器的页面
│   ├── thumbnail.jpg       # 缩略图
│   ├── preview.webm       # 预览视频
│   └── collection_log.txt  # 采集日志
└── ph63203a153b509/
    ├── index.html
    ├── thumbnail.jpg
    ├── preview.webm
    └── collection_log.txt
```

### 3. 打开HTML页面

用浏览器打开 `data/[viewkey]/index.html` 文件，你将看到：

- **视频信息区域**: 显示视频标题、时长、上传者等信息
- **预览视频播放器**: 播放采集到的预览视频
- **M3U8播放器**: 新添加的功能，可以播放m3u8地址视频
- **质量选择按钮**: 可以选择不同清晰度的m3u8地址

## 新功能特性

### M3U8播放器区域

```
┌─────────────────────────────────────┐
│           M3U8 视频播放器           │
├─────────────────────────────────────┤
│                                     │
│        [视频播放器]                 │
│                                     │
├─────────────────────────────────────┤
│ [播放最佳质量]                      │
│                                     │
│ 可用质量:                           │
│ [1080P] [720P] [480P] [240P]       │
└─────────────────────────────────────┘
```

### 功能特点

1. **自动播放**: 页面加载后自动播放最佳质量的m3u8视频
2. **质量选择**: 点击不同质量按钮切换播放清晰度
3. **状态提示**: 显示加载状态和错误信息
4. **响应式设计**: 适配不同屏幕尺寸

## 测试独立播放器

如果想单独测试m3u8播放功能，可以使用独立的播放器页面：

```bash
# 在浏览器中打开
m3u8_player.html
```

这个页面提供了：
- 手动输入m3u8地址的功能
- 测试用的示例m3u8地址
- 基础的播放控制

## 浏览器兼容性

### 推荐浏览器
- **Chrome 50+**: 完全支持，最佳体验
- **Firefox 52+**: 完全支持
- **Safari 11+**: 原生支持HLS
- **Edge 79+**: 完全支持

### 功能支持
- ✅ HLS.js播放
- ✅ 多质量切换
- ✅ 自动播放
- ✅ 错误处理
- ✅ 状态提示

## 故障排除

### 常见问题

1. **视频无法播放**
   ```
   解决方案:
   - 检查网络连接
   - 确认m3u8地址有效
   - 尝试其他质量选项
   - 检查浏览器是否支持HLS
   ```

2. **播放器不显示**
   ```
   解决方案:
   - 确认JavaScript已启用
   - 检查浏览器控制台是否有错误
   - 尝试刷新页面
   ```

3. **加载缓慢**
   ```
   解决方案:
   - 检查网络带宽
   - 尝试较低质量选项
   - 等待一段时间让视频缓冲
   ```

### 调试方法

1. **打开浏览器开发者工具** (F12)
2. **查看控制台** 是否有错误信息
3. **检查网络面板** 确认m3u8文件是否正常加载
4. **查看元素面板** 确认播放器HTML是否正确生成

## 高级用法

### 自定义播放器样式

可以修改 `app.py` 中的 `create_html_page` 方法来自定义播放器样式：

```python
# 在create_html_page方法中修改CSS样式
.m3u8-player-section {
    /* 自定义样式 */
}
```

### 添加更多功能

可以在JavaScript部分添加更多功能：

```javascript
// 添加播放速度控制
function setPlaybackRate(rate) {
    const video = document.getElementById('m3u8Player');
    if (video) {
        video.playbackRate = rate;
    }
}

// 添加全屏功能
function toggleFullscreen() {
    const video = document.getElementById('m3u8Player');
    if (video.requestFullscreen) {
        video.requestFullscreen();
    }
}
```

## 更新日志

- **v1.0** (2024-01-01): 初始版本
  - 添加基础m3u8播放功能
  - 支持多质量选择
  - 添加状态提示
  - 优化用户体验

## 技术支持

如果遇到问题，请检查：

1. **代码版本**: 确保使用最新版本的 `app.py`
2. **依赖库**: 确保所有Python依赖已正确安装
3. **浏览器版本**: 使用推荐的浏览器版本
4. **网络环境**: 确保网络连接稳定

## 联系信息

如有问题或建议，请查看项目文档或提交issue。 